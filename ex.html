<html>


<script>

if (typeof(DeviceMotionEvent) !== 'undefined' && typeof(DeviceMotionEvent.requestPermission) === 'function') {
          
          DeviceMotionEvent.requestPermission()
          .then(response => {
	alert('Orientation tracking '+ response);
          
            if (response == 'granted') {
              window.addEventListener('devicemotion', (e) => {
               alert('DeviceMotionEvent:' + e);
              })
            }
          })
      .catch(console.error)
      }else {
          alert('DeviceMotionEvent is not defined');
      }

    let status = document.getElementById('status');
    let heading = document.getElementById('heading');
    if ( 'Magnetometer' in window ) {
      let sensor = new Magnetometer();
      sensor.addEventListener('reading', function(e) {
        status.innerHTML = 'x: ' + e.target.x + '<br> y: ' + e.target.y + '<br> z: ' + e.target.z;
        let headingDegrees = 'Heading: ' + Math.atan2(e.target.y, e.target.x) * (180 / Math.PI);
        heading.innerHTML = headingDegrees;
      });
      sensor.start();
    }
    else status.innerHTML = 'Magnetometer not supported';

</script>

<body>

<div id="status"></div>

</body>

</html>