<html>


<script>

navigator.permissions.query({ name: 'accelerometer' })
.then(result => {
  if (result.state === 'denied') {
    console.log('Permission to use accelerometer sensor is denied.');
    return;
  }
  
  let status = document.getElementById('status');
    let heading = document.getElementById('heading');
    if ( 'Magnetometer' in window ) {
      let sensor = new Magnetometer();
      sensor.addEventListener('reading', function(e) {
        status.innerHTML = 'x: ' + e.target.x + '<br> y: ' + e.target.y + '<br> z: ' + e.target.z;
        let headingDegrees = 'Heading: ' + Math.atan2(e.target.y, e.target.x) * (180 / Math.PI);
        heading.innerHTML = headingDegrees;
      });
      sensor.start();
    }
    else status.innerHTML = 'Magnetometer not supported';
	
});

    

</script>

<body>

<div id="status">No data</div>
<div id="heading">No data</div>

</body>

</html>